datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

// --- NextAuth Models ---

model User {
  id            String    @id @default(cuid())
  name          String?
  email         String?   @unique
  emailVerified DateTime?
  image         String?
  password      String?
  role          String?   @default("user")
  accounts      Account[]
  sessions      Session[]
  posts         Post[]
}

model Account {
  id                 String  @id @default(cuid())
  userId             String
  type               String
  provider           String
  providerAccountId  String
  refresh_token      String? @db.Text
  access_token       String? @db.Text
  expires_at         Int?
  token_type         String?
  scope              String?
  id_token           String? @db.Text
  session_state      String?

  user User @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([provider, providerAccountId])
}

model Session {
  id           String   @id @default(cuid())
  sessionToken String   @unique
  userId       String
  expires      DateTime
  user         User     @relation(fields: [userId], references: [id], onDelete: Cascade)
}

model VerificationToken {
  identifier String
  token      String   @unique
  expires    DateTime

  @@unique([identifier, token])
}

// --- CMS Models ---

model Post {
  id        String   @id @default(cuid())
  title     String
  slug      String   @unique
  content   Json?
  excerpt   String?
  imageUrl  String?
  published Boolean? @default(false)
  authorId  String?
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  author User? @relation(fields: [authorId], references: [id])
}

model Product {
  id          String      @id @default(cuid())
  name        String
  slug        String      @unique
  description String?
  price       Decimal
  currency    String?     @default("USD")
  images      String[]
  stock       Int?        @default(0)
  createdAt   DateTime    @default(now())
  updatedAt   DateTime    @updatedAt
  isArchived  Boolean     @default(false)
  orderItems  OrderItem[]
}

model PuckPage {
  id          String   @id @default(cuid())
  path        String   @unique
  title       String?
  description String?
  imageUrl    String?
  body        String?
  isPublished Boolean? @default(true)
  data        Json
  updatedAt   DateTime @updatedAt
  createdAt   DateTime @default(now())
}

model Order {
  id                String      @id @default(cuid())
  customerName      String
  customerEmail     String
  customerAddress   String
  total             Decimal
  status            String?     @default("pending")
  paymentStatus     String?     @default("pending")
  fulfillmentStatus String?     @default("unfulfilled")
  createdAt         DateTime    @default(now())
  items             OrderItem[]
}

model OrderItem {
  id        String  @id @default(cuid())
  orderId   String
  productId String
  quantity  Int
  price     Decimal

  order   Order   @relation(fields: [orderId], references: [id], onDelete: Cascade)
  product Product @relation(fields: [productId], references: [id])
}

model PaymentSettings {
  id            String   @id @default(cuid())
  bankName      String
  accountNumber String
  accountHolder String
  currency      String?  @default("USD")
  instructions  String?
  updatedAt     DateTime @updatedAt
}

model Testimonial {
  id         String   @id @default(cuid())
  quote      String
  author     String
  role       String?
  avatarUrl  String?
  rating     Int?     @default(5)
  isApproved Boolean? @default(false)
  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt
}

model SiteSettings {
  id                          String   @id @default(cuid())
  siteName                    String?  @default("My Awesome Site")
  logoUrl                     String?
  description                 String?
  seoTitle                    String?
  seoKeywords                 String?
  seoImage                    String?
  faviconUrl                  String?
  footerAddress               String?
  footerCopyright             String?
  footerAboutText             String?
  socialFacebook              String?
  socialTwitter               String?
  socialInstagram             String?
  socialLinkedin              String?
  socialWhatsapp              String?
  socialTelegram              String?
  contactEmail                String?
  brandColor                  String?  @default("#CE1111")
  headerStyle                 String?  @default("simple")
  headerBackgroundColor       String?  @default("#ffffff")
  headerTextColor             String?  @default("111827")
  showCart                    Boolean? @default(true)
  showFloatingChat            Boolean? @default(false)
  whatsappNumber              String?
  headerMobileBackgroundColor String?  @default("#f9fafb")
  footerBackgroundColor       String?  @default("#CE1111")
  footerTextColor             String?  @default("#ffffff")
  googleSiteVerificationId    String?
  googleAnalyticsId           String?
  updatedAt                   DateTime @updatedAt
}

model SiteStatistics {
  id          String   @id @default(cuid())
  totalViews  Int?     @default(0)
  todayViews  Int?     @default(0)
  lastUpdated DateTime @default(now()) @updatedAt
}

model Menu {
  id        String     @id @default(cuid())
  name      String
  slug      String     @unique
  createdAt DateTime   @default(now())
  updatedAt DateTime   @updatedAt
  items     MenuItem[]
}

model MenuItem {
  id        String   @id @default(cuid())
  menuId    String
  label     String
  url       String
  order     Int      @default(0)
  target    String?  @default("_self")
  parentId  String?
  createdAt DateTime @default(now())

  menu Menu @relation(fields: [menuId], references: [id], onDelete: Cascade)
}

model ContactSubmission {
  id        String   @id @default(cuid())
  name      String
  email     String
  subject   String?
  message   String
  status    String?  @default("new")
  createdAt DateTime @default(now())
}

model GalleryItem {
  id          String   @id @default(cuid())
  title       String?
  url         String
  description String?
  createdAt   DateTime @default(now())
}

model PortfolioItem {
  id          String   @id @default(cuid())
  title       String
  category    String
  imageUrl    String
  link        String?
  description String?
  createdAt   DateTime @default(now())
}

model MediaItem {
  id        String   @id @default(cuid())
  filename  String
  url       String
  mimeType  String
  size      Int
  createdAt DateTime @default(now())
}
